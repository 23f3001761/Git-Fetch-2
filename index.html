<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>GitHub User - Creation Date</title>
  <!-- Bootstrap CSS (latest stable via jsDelivr) -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5/dist/css/bootstrap.min.css" rel="stylesheet"/>
  <style>
    /* Small layout tweak for better presentation on small screens */
    #github-created-at {
      min-height: 1.25em;
    }
  </style>
</head>
<body>
  <div class="container py-4">
    <h1 class="mb-4">GitHub User - Creation Date</h1>

    <!-- ARIA-live status alert -->
    <div id="github-status" class="alert alert-info mt-2 mb-3" role="status" aria-live="polite" aria-atomic="true">
      Awaiting lookup. Enter a GitHub username and press Enter or click Get Creation Date.
    </div>

    <!-- Lookup form -->
    <form id="github-user-100" class="row g-3 align-items-center" autocomplete="off" novalidate>
      <div class="col-auto flex-grow-1">
        <label class="visually-hidden" for="github-username">GitHub username</label>
        <input type="text" class="form-control" id="github-username" placeholder="GitHub username" required />
      </div>
      <div class="col-auto">
        <button type="submit" class="btn btn-primary">Get Creation Date</button>
      </div>
    </form>

    <!-- Display creation date in UTC (YYYY-MM-DD) -->
    <div class="mt-3" id="github-created-at" aria-live="off"></div>

    <div class="mt-2 text-muted small">
      Hint: You can provide a token via the URL as ?token=YOUR_TOKEN to authenticate requests.
    </div>
  </div>

  <!-- Bootstrap Bundle JS (latest stable via jsDelivr) -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5/dist/js/bootstrap.bundle.min.js"></script>

  <script>
    (function () {
      const form = document.getElementById('github-user-100');
      const usernameInput = document.getElementById('github-username');
      const createdAtDiv = document.getElementById('github-created-at');
      const statusDiv = document.getElementById('github-status');

      // Token can be supplied via URL ?token=...; use it if provided
      const urlParams = new URLSearchParams(window.location.search);
      const tokenFromQuery = (urlParams.get('token') || '').trim();

      function setStatus(message) {
        if (statusDiv) {
          statusDiv.textContent = message;
        }
      }

      form.addEventListener('submit', async function (e) {
        e.preventDefault();
        const username = (usernameInput.value || '').trim();
        if (!username) {
          setStatus('Lookup failed: please enter a GitHub username.');
          createdAtDiv.textContent = '';
          return;
        }

        setStatus(`Starting lookup for '${username}'...`);
        createdAtDiv.textContent = '';

        const headers = { 'Accept': 'application/vnd.github+json' };
        if (tokenFromQuery) {
          headers['Authorization'] = `token ${tokenFromQuery}`;
        }

        try {
          const res = await fetch(`https://api.github.com/users/${encodeURIComponent(username)}`, { headers });
          if (!res.ok) {
            let errMsg = 'Lookup failed';
            let detail = '';
            try {
              const data = await res.json();
              if (data && data.message) detail = data.message;
            } catch (_) { /* ignore parse errors */ }

            if (res.status === 404) errMsg = 'User not found';
            else if (detail) errMsg = detail;
            setStatus(`${errMsg} (HTTP ${res.status})`);
            createdAtDiv.textContent = '';
            return;
          }

          const user = await res.json();
          const createdAt = user.created_at;
          if (createdAt) {
            const dateObj = new Date(createdAt);
            const dateStr = dateObj.toISOString().split('T')[0]; // UTC date
            createdAtDiv.textContent = `Account created at: ${dateStr} UTC`;
            setStatus('Lookup succeeded.');
          } else {
            createdAtDiv.textContent = 'Creation date not available';
            setStatus('Lookup completed without creation date.');
          }
        } catch (err) {
          setStatus(`Lookup failed: ${err?.message || err}`);
          createdAtDiv.textContent = '';
        }
      });
    })();
  </script>
</body>
</html>